{% extends "base.html" %}
{% load static %}

{% block imgHome %}
<img class="home_pic" src="{% static 'img/active_home.svg' %}" alt="main_left" />
{% endblock %}

{% block title %}
Main
{% endblock %}

{% block active_main %}
active_text
{% endblock %}

{% block content%}
<div class="post">
  {% if request.user.username %}
  <div class="user_add_post">
    <img class="avatar online" src="{% static 'assets/dp.png' %}" alt="avatar" />
    <div class="about_user">
      <span class="nickname_post">{{user.username}}</span>
    </div>
  </div>
  <form method="post" enctype="multipart/form-data" action="{% url 'our_post' %}" class="post_add">
    {% csrf_token %}
   
    <p><label for="{{ form.message.id_for_label }}" class="m-8"></label>{{ form.message }}</p>
    <p><label for="{{ form.content.id_for_label }}" class="m-8"><img
          src="{% static 'img/lenta/picture.svg' %}" /></label>{{ form.content }}</p>
    <div class="d-f m-8">
      <div class="row">
        <div class="post_content" id="contentBox">
        </div>
      </div>
      <button class="button_post">Надіслати</button>
    </div>
  </form>
  {%endif%}
  <div class="error_message" id="error">
  </div>
  {% for a in posts %}
  <div class="user_post">
    <a href="{{ a.userId.getUsernameProfile }}" class="user_avatar-link"><img class="avatar online" src="{% static 'assets/dp.png' %}"
      alt="avatar" /></a>
    <div class="about_user">
    
      <a href="{{ a.userId.getUsernameProfile }}" class="nickname_post">{{a.userId}}</a>
 
      <span class="post_subtitle">
        {{a.message}}
      </span>
      {% for img in a.content.all %}
      <div class="div_image_post">
        <img src="{{img.photo.url}}" class="image_post" />
      </div>
      {% endfor%}
      <div class="about_post">
        <div class="post_like">
          {%if request.user.is_authenticated %}
          {% if a.id in like_posts %}
          <img src="{% static 'img/lenta/likeClick.png'%}" style="cursor:pointer;"
            class="likebutton {{a.id}} likebutton_none{{a.id}} d-b" id="likebutton_none" />
          <img src="{% static 'img/lenta/like.svg'%}" style="cursor:pointer;"
            class="likebutton_none {{a.id}} likebutton{{a.id}} d-n" id="likebutton" />
          {% else %}
          <img src="{% static 'img/lenta/like.svg'%}" style="cursor:pointer;"
            class="likebutton {{a.id}} likebutton{{a.id}} d-b" id="likebutton" />
          <img src="{% static 'img/lenta/likeClick.png'%}" style="cursor:pointer;"
            class="likebutton_none {{a.id}} likebutton_none{{a.id}} d-n" id="likebutton_none" />
          {% endif %}
          {% else %}
          <a href="{% url 'login' %}" style="text-decoration:none;"><img src="{% static 'img/lenta/like.svg'%}" style="cursor:pointer;"
            class="likebutton {{a.id}} likebutton_none{{a.id}} d-b" id="likebutton_none" /></a>
          {%endif%}
          {% for key, value in number_like.items %}
          {% if key == a.id %}
          <span class="like_number like_number{{key}}">{{ value }}</span>
          {% endif %}
          {% endfor %}
          {% if a.id not in all_id_post%}
          <span class="like_number like_number{{a.id}}">0</span>
          {% endif %}
        </div>
        <div class="post_comment">
          <a href="{{ a.get_absolute_url }}" class="nickname"><img
              src="{% static 'img/lenta/comment.svg'%}" class="post_comment-img" /></a>
          {% for key, value in id_comment.items %}
          {% if key == a.id %}
          <span>{{ value }}</span>
          {% endif %}
          {% endfor %}
        </div>
        <div class="post_time">
          <span>{{ a.createdAt|date:"M d" }}</span>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{% static 'js/textarea.js' %}"></script>
<script src="{% static 'js/addimg.js' %}"></script>
<script src="{% static 'js/like.js' %}"></script>
{% endblock %}
